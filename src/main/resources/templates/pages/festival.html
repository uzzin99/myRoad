<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
  <th:block th:replace="~{fragments/header.html :: fragment-header}"></th:block>
</head>
<style>
.icon-lg {
    width: 300px;
    height: 250px;
}

</style>
<body class="g-sidenav-show bg-gray-100">
<div class="min-height-300 bg-dark position-absolute w-100"></div>

<!--aside-->
<th:block th:replace="~{fragments/aside.html :: fragment-aside}"></th:block>
<!--End aside-->

<main class="main-content position-relative border-radius-lg">

  <!-- Navbar -->
  <th:block th:replace="~{fragments/nav.html :: fragment-nav}"></th:block>
  <!-- End Navbar -->

  <div class="container-fluid py-4">
    <div class="row">
      <div class="col-12">
        <div class="card mb-4">
          <div class="card-header pb-0">
            <h6>전국 축제 일정</h6>
          </div>
          <div class="card-body ">
              <div class="row">
                <div class="col-md-3 mt-md-0 mt-4 mb-4">
                  <div class="card">
                    <div class="card-header mx-4 p-3 text-center">
                      <div class="icon icon-shape icon-lg bg-gradient-primary shadow text-center border-radius-lg">
                        <i class="fas fa-landmark opacity-10"></i>
                      </div>
                    </div>
                    <div class="card-body pt-0 p-3 text-center">
                      <h6 class="text-center mb-0">Salary</h6>
                      <span class="text-xs">Belong Interactive</span>
                      <hr class="horizontal dark my-3">
                      <h5 class="mb-0">+$2000</h5>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
    </div>
  </div>
  <!--footer-->
  <th:block th:replace="~{fragments/footer.html :: fragment-footer}"></th:block>
  <!--End footer-->
  </div>
</main>
<th:block th:replace="~{fragments/footer.html :: fragment-plugin}"></th:block>

<th:block th:replace="~{fragments/scripts.html :: fragment-footer-scripts}"></th:block>
</body>
<script>
  function loadFestivals() {
    axios.get(`/api/festival/list`)
      .then(response => {
        const data = response.data;
        const festivals = data;

        const cardRow = document.createElement("div");
        cardRow.className = "row";

        festivals.forEach(festival => {
          const col = document.createElement("div");
          col.className = "col-md-3 mt-md-0 mt-4 mb-4";

          const imageTag = festival.firstimage
            ? `<img src="${festival.firstimage}" alt="${festival.title}" class="icon-lg border-radius-lg shadow" style="object-fit: cover;">`
            : `<div class="icon icon-shape icon-lg bg-gradient-secondary shadow text-center border-radius-lg d-flex align-items-center justify-content-center">
                <i class="fas fa-image opacity-6"></i>
               </div>`; // 이미지 없을 경우 대체 아이콘

          const cardHTML = `
            <div class="card h-100">
              <div class="card-header mx-4 p-3 text-center">
                ${imageTag}
              </div>
              <div class="card-body pt-0 p-3 text-center">
                <h6 class="text-center mb-0">${festival.title}</h6>
                <span class="text-xs">${festival.addr1 || '주소 정보 없음'}</span>
                <hr class="horizontal dark my-3">
                <p class="mb-0">${festival.eventstartdate} ~ ${festival.eventenddate}</p>
                <a class="btn btn-sm btn-primary mt-2" href="https://korean.visitkorea.or.kr/detail/fes_detail.do?cotid=${festival.contentid}" target="_blank">후기</a>
                <a class="btn btn-sm btn mt-2" href="" target="_blank">담기</a>
              </div>
            </div>
          `;

          col.innerHTML = cardHTML;
          cardRow.appendChild(col);
        });

        const container = document.querySelector(".card-body");
        container.innerHTML = ""; // 기존 내용 삭제
        container.appendChild(cardRow);
      })
      .catch(error => {
        console.error("축제 정보 불러오기 실패:", error);
      });
  }

  document.addEventListener("DOMContentLoaded", loadFestivals);
</script>
</html>